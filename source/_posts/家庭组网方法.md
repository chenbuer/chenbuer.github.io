---
title: 家庭组网方法
date: 2024-10-5 12:35:52
categories: 运维
tags: 网络
---

家庭可以获取公网ipv6，但没有公网ipv4。所以，openwrt功能：
- 配置ipv6。openwrt进行pppoe拨号获取ipv4和ipv6，并给接入终端分配公网ipv6。
- 配置ddns-go，域名可动态获取公网ipv6地址
- 配置wireguard，在外的流量可以回家
- 配置wol。在nas不需要的时候页面关闭，需要时候利用openwrt来wol唤醒
- cloudflare tunnel。TODO://看看放到哪台机器上。
<!--more-->
## 一、配置ipv6
[IPv6新手入门](https://www.youtube.com/watch?v=dQ1AMXAiEJk)
[ipv6工作流程详解](https://www.youtube.com/watch?v=klQ6JbZEeJ0)
## 二、ddns-go
## 三、wireguard
握手时，利用公网ipv6。握手成功之后，在外的终端设备就像加入了家庭的局域网，可以利用家庭局域网的ipv4地址进行互访。
## 四、wol
安装luci-i18n-wol-zh-cn（依赖luci-i18n-wol和etherwake）。

## 二、pi
- ddns-go
- cloudflare：cf tunnel出去op和群辉5000等
- nginx反向代理
- jellyfin
- 挂载群辉samba
    - 测试
    ```shell
    sudo mount -t cifs //172.16.18.18/docker/jellyfin/media /mnt/ds/media -o username=jellyfin,password=oIuezh,vers=2.0
    ```
    - 任务，编辑`/etc/fstab`，末尾增加一行
    ```shell
    //172.16.18.18/docker/jellyfin/media /mnt/ds/media cifs username=jellyfin,password=oIuezh,vers=2.0,uid=1000,gid=1000,_netdev,x-systemd.automount,x-systemd.idle-timeout=60,x-systemd.device-timeout=5s,x-systemd.mount-timeout=5s 0 0
    ```
    - 编辑之后`sudo systemctl daemon-reload & sudo mount -a`去挂载
- nginx反向代理
https://www.bilibili.com/video/BV1ULbJevEGj/
https://mixuying.com/archives/1720316602169